<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Verification For Continually Updating Timeseries Data • butterfly</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Verification For Continually Updating Timeseries Data">
<meta name="description" content="Verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged.">
<meta property="og:description" content="Verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged.">
<meta property="og:image" content="https://thomaszwagerman.github.io/butterfly/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">butterfly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/butterfly.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/butterfly_in_pipeline.html">Using butterfly in an operational data pipeline</a></li>
    <li><a class="dropdown-item" href="articles/butterfly_paper.html">butterfly: An R package for the verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged.</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/butterfly/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="butterfly-">butterfly 
<a class="anchor" aria-label="anchor" href="#butterfly-"></a>
</h1>
</div>
<!-- badges: start -->

<p>The goal of butterfly is to aid in the verification of continually updating timeseries data, where we expect new values over time, but want to ensure previous data remains unchanged, and timesteps remain continuous.</p>
<div class="figure">
<img src="reference/figures/README-butterfly_diagram.png" alt="An illustration of continually updating timeseries data where a previous value unexpectedly changes." width="100%"><p class="caption">
An illustration of continually updating timeseries data where a previous value unexpectedly changes.
</p>
</div>
<p>Data previously recorded could change for a number of reasons, such as discovery of an error in model code, a change in methodology or instrument recalibration. Monitoring data sources for these changes is not always possible.</p>
<p>Unnoticed changes in previous data could have unintended consequences, such as invalidating a published dataset’s Digital Object Identfier (DOI), or altering future predictions if used as input in forecasting models.</p>
<p>Other unnoticed changes could include a jump in time or measurement frequency, due to instrument failure or software updates.</p>
<div class="figure">
<img src="reference/figures/README-timeseries_dark.png" alt="An illustration of timeseries data not being continuous in the way it is expected to be." width="100%"><p class="caption">
An illustration of timeseries data not being continuous in the way it is expected to be.
</p>
</div>
<p>This package provides functionality that can be used as part of a data pipeline, to check and flag changes to previous data to prevent changes going unnoticed.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install butterfly with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"butterfly"</span>, repos <span class="op">=</span> <span class="st">"https://ropensci.r-universe.dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The butterfly package contains the following functions:</p>
<ul>
<li>
<code><a href="reference/loupe.html">butterfly::loupe()</a></code> - examines in detail whether previous values have changed, and returns TRUE/FALSE for no change/change.</li>
<li>
<code><a href="reference/catch.html">butterfly::catch()</a></code> - returns rows which contain previously changed values in a dataframe.</li>
<li>
<code><a href="reference/release.html">butterfly::release()</a></code> - drops rows which contain previously changed values, and returns a dataframe containing new and unchanged rows.</li>
<li>
<code><a href="reference/create_object_list.html">butterfly::create_object_list()</a></code> - returns a list of objects required by all of <code><a href="reference/loupe.html">loupe()</a></code>, <code><a href="reference/catch.html">catch()</a></code> and <code><a href="reference/release.html">release()</a></code>. Contains underlying functionality.</li>
<li>
<code><a href="reference/timeline.html">butterfly::timeline()</a></code> - check if a timeseries is continuous between timesteps.</li>
<li>
<code><a href="reference/timeline_group.html">butterfly::timeline_group()</a></code> - group distinct, but continuous sequences of a timeseries.</li>
</ul>
<p>There are also dummy datasets, which a fictional and purely to demonstrate butterfly functionality:</p>
<ul>
<li>
<code>butterflycount</code> - a list of monthly dataframes, which contain fictional butterfly counts for a given date.</li>
<li>
<code>forestprecipitation</code> - a list of monthly dataframes, which contain fictional daily precipitation measurements for a given date.</li>
<li>
<code>butterflymess</code> - a messy version of <code>butterflycount</code>, provided for testing purposes.</li>
</ul>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>This is a basic example which shows you how to use butterfly:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/butterfly" class="external-link">butterfly</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Imagine a continually updated dataset that starts in January and is updated once a month</span></span>
<span><span class="va">butterflycount</span><span class="op">$</span><span class="va">january</span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-01-01    22</span></span>
<span><span class="co">#&gt; 2 2023-12-01    55</span></span>
<span><span class="co">#&gt; 3 2023-11-01    11</span></span>
<span></span>
<span><span class="co"># In February an additional row appears, all previous data remains the same</span></span>
<span><span class="va">butterflycount</span><span class="op">$</span><span class="va">february</span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-02-01    17</span></span>
<span><span class="co">#&gt; 2 2024-01-01    22</span></span>
<span><span class="co">#&gt; 3 2023-12-01    55</span></span>
<span><span class="co">#&gt; 4 2023-11-01    11</span></span>
<span></span>
<span><span class="co"># In March an additional row appears again</span></span>
<span><span class="co"># ...but a previous value has unexpectedly changed</span></span>
<span><span class="va">butterflycount</span><span class="op">$</span><span class="va">march</span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-03-01    23</span></span>
<span><span class="co">#&gt; 2 2024-02-01    17</span></span>
<span><span class="co">#&gt; 3 2024-01-01    22</span></span>
<span><span class="co">#&gt; 4 2023-12-01    55</span></span>
<span><span class="co">#&gt; 5 2023-11-01    18</span></span></code></pre></div>
<p>We can use <code><a href="reference/loupe.html">butterfly::loupe()</a></code> to examine in detail whether previous values have changed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/loupe.html">loupe</a></span><span class="op">(</span></span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">february</span>,</span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">january</span>,</span>
<span>  datetime_variable <span class="op">=</span> <span class="st">"time"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The following rows are new in 'df_current': </span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-02-01    17</span></span>
<span><span class="co">#&gt; ✔ And there are no differences with previous data.</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/loupe.html">loupe</a></span><span class="op">(</span></span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">march</span>,</span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">february</span>,</span>
<span>  datetime_variable <span class="op">=</span> <span class="st">"time"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The following rows are new in 'df_current': </span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-03-01    23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ The following values have changes from the previous data.</span></span>
<span><span class="co">#&gt; old vs new</span></span>
<span><span class="co">#&gt;            count</span></span>
<span><span class="co">#&gt;   old[1, ]    17</span></span>
<span><span class="co">#&gt;   old[2, ]    22</span></span>
<span><span class="co">#&gt;   old[3, ]    55</span></span>
<span><span class="co">#&gt; - old[4, ]    18</span></span>
<span><span class="co">#&gt; + new[4, ]    11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; `old$count`: 17.0 22.0 55.0 18.0</span></span>
<span><span class="co">#&gt; `new$count`: 17.0 22.0 55.0 11.0</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p><code><a href="reference/loupe.html">butterfly::loupe()</a></code> uses <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">dplyr::semi_join()</a></code> to match the new and old objects using a common unique identifier, which in a timeseries will be the timestep. <code><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">waldo::compare()</a></code> is then used to compare these and provide a detailed report of the differences.</p>
<p><code>butterfly</code> follows the <code>waldo</code> philosophy of erring on the side of providing too much information, rather than too little. It will give a detailed feedback message on the status between two objects.</p>
<div class="section level3">
<h3 id="using-butterfly-for-data-wrangling">Using butterfly for data wrangling<a class="anchor" aria-label="anchor" href="#using-butterfly-for-data-wrangling"></a>
</h3>
<p>You might want to return changed rows as a dataframe, or drop them altogether. For this <code><a href="reference/catch.html">butterfly::catch()</a></code> and <code><a href="reference/release.html">butterfly::release()</a></code> are provided.</p>
<p>Here, <code><a href="reference/catch.html">butterfly::catch()</a></code> only returns rows which have <strong>changed</strong> from the previous version. It will not return new rows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_caught</span> <span class="op">&lt;-</span> <span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/catch.html">catch</a></span><span class="op">(</span></span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">march</span>,</span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">february</span>,</span>
<span>  datetime_variable <span class="op">=</span> <span class="st">"time"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The following rows are new in 'df_current': </span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-03-01    23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ The following values have changes from the previous data.</span></span>
<span><span class="co">#&gt; old vs new</span></span>
<span><span class="co">#&gt;            count</span></span>
<span><span class="co">#&gt;   old[1, ]    17</span></span>
<span><span class="co">#&gt;   old[2, ]    22</span></span>
<span><span class="co">#&gt;   old[3, ]    55</span></span>
<span><span class="co">#&gt; - old[4, ]    18</span></span>
<span><span class="co">#&gt; + new[4, ]    11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; `old$count`: 17.0 22.0 55.0 18.0</span></span>
<span><span class="co">#&gt; `new$count`: 17.0 22.0 55.0 11.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Only these rows are returned.</span></span>
<span></span>
<span><span class="va">df_caught</span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2023-11-01    18</span></span></code></pre></div>
<p>Conversely, <code><a href="reference/release.html">butterfly::release()</a></code> drops all rows which had changed from the previous version. Note it retains new rows, as these were expected.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_released</span> <span class="op">&lt;-</span> <span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/release.html">release</a></span><span class="op">(</span></span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">march</span>,</span>
<span>  <span class="va">butterflycount</span><span class="op">$</span><span class="va">february</span>,</span>
<span>  datetime_variable <span class="op">=</span> <span class="st">"time"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; The following rows are new in 'df_current': </span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-03-01    23</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ The following values have changes from the previous data.</span></span>
<span><span class="co">#&gt; old vs new</span></span>
<span><span class="co">#&gt;            count</span></span>
<span><span class="co">#&gt;   old[1, ]    17</span></span>
<span><span class="co">#&gt;   old[2, ]    22</span></span>
<span><span class="co">#&gt;   old[3, ]    55</span></span>
<span><span class="co">#&gt; - old[4, ]    18</span></span>
<span><span class="co">#&gt; + new[4, ]    11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; `old$count`: 17.0 22.0 55.0 18.0</span></span>
<span><span class="co">#&gt; `new$count`: 17.0 22.0 55.0 11.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ These will be dropped, but new rows are included.</span></span>
<span></span>
<span><span class="va">df_released</span></span>
<span><span class="co">#&gt;         time count</span></span>
<span><span class="co">#&gt; 1 2024-03-01    23</span></span>
<span><span class="co">#&gt; 2 2024-02-01    17</span></span>
<span><span class="co">#&gt; 3 2024-01-01    22</span></span>
<span><span class="co">#&gt; 4 2023-12-01    55</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="checking-for-continuity-timeline">Checking for continuity: <code>timeline()</code>
<a class="anchor" aria-label="anchor" href="#checking-for-continuity-timeline"></a>
</h3>
<p>To check if a timeseries is continuous, <code><a href="reference/timeline.html">timeline()</a></code> and <code><a href="reference/timeline_group.html">timeline_group()</a></code> are provided.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A rain gauge which measures precipitation every day</span></span>
<span><span class="fu">butterfly</span><span class="fu">::</span><span class="va"><a href="reference/forestprecipitation.html">forestprecipitation</a></span><span class="op">$</span><span class="va">january</span></span>
<span><span class="co">#&gt;         time rainfall_mm</span></span>
<span><span class="co">#&gt; 1 2024-01-01         0.0</span></span>
<span><span class="co">#&gt; 2 2024-01-02         2.6</span></span>
<span><span class="co">#&gt; 3 2024-01-03         0.0</span></span>
<span><span class="co">#&gt; 4 2024-01-04         0.0</span></span>
<span><span class="co">#&gt; 5 2024-01-05         3.7</span></span>
<span><span class="co">#&gt; 6 2024-01-06         0.8</span></span>
<span></span>
<span><span class="co"># In February there is a power failure in the instrument</span></span>
<span><span class="fu">butterfly</span><span class="fu">::</span><span class="va"><a href="reference/forestprecipitation.html">forestprecipitation</a></span><span class="op">$</span><span class="va">february</span></span>
<span><span class="co">#&gt;         time rainfall_mm</span></span>
<span><span class="co">#&gt; 1 2024-02-01         1.1</span></span>
<span><span class="co">#&gt; 2 2024-02-02         0.0</span></span>
<span><span class="co">#&gt; 3 2024-02-03         1.4</span></span>
<span><span class="co">#&gt; 4 2024-02-04         2.2</span></span>
<span><span class="co">#&gt; 5 1970-01-01         3.4</span></span>
<span><span class="co">#&gt; 6 1970-01-02         0.6</span></span></code></pre></div>
<p>To check if a timeseries is continuous:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/timeline.html">timeline</a></span><span class="op">(</span></span>
<span>   <span class="va">forestprecipitation</span><span class="op">$</span><span class="va">january</span>,</span>
<span>   datetime_variable <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   expected_lag <span class="op">=</span> <span class="fl">1</span></span>
<span> <span class="op">)</span></span>
<span><span class="co">#&gt; ✔ There are no time lags which are greater than the expected lag: 1 days. By this measure, the timeseries is continuous.</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>In February our imaginary rain gauge’s onboard computer had a failure.</p>
<p>The timestamp was reset to <code>1970-01-01</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forestprecipitation</span><span class="op">$</span><span class="va">february</span></span>
<span><span class="co">#&gt;         time rainfall_mm</span></span>
<span><span class="co">#&gt; 1 2024-02-01         1.1</span></span>
<span><span class="co">#&gt; 2 2024-02-02         0.0</span></span>
<span><span class="co">#&gt; 3 2024-02-03         1.4</span></span>
<span><span class="co">#&gt; 4 2024-02-04         2.2</span></span>
<span><span class="co">#&gt; 5 1970-01-01         3.4</span></span>
<span><span class="co">#&gt; 6 1970-01-02         0.6</span></span>
<span></span>
<span><span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/timeline.html">timeline</a></span><span class="op">(</span></span>
<span>  <span class="va">forestprecipitation</span><span class="op">$</span><span class="va">february</span>,</span>
<span>   datetime_variable <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   expected_lag <span class="op">=</span> <span class="fl">1</span></span>
<span> <span class="op">)</span></span>
<span><span class="co">#&gt; ℹ There are time lags which are greater than the expected lag: 1 days. This indicates the timeseries is not continuous. There are 2 distinct continuous sequences. Use `timeline_group()` to extract.</span></span>
<span><span class="co">#&gt; [1] FALSE</span></span></code></pre></div>
<p>If we wanted to group chunks of our timeseries that are distinct, or broken up in some way, but still continuous, we can use <code><a href="reference/timeline_group.html">timeline_group()</a></code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">butterfly</span><span class="fu">::</span><span class="fu"><a href="reference/timeline_group.html">timeline_group</a></span><span class="op">(</span></span>
<span>  <span class="va">forestprecipitation</span><span class="op">$</span><span class="va">february</span>,</span>
<span>   datetime_variable <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>   expected_lag <span class="op">=</span> <span class="fl">1</span></span>
<span> <span class="op">)</span></span>
<span><span class="co">#&gt;         time rainfall_mm        timelag timeline_group</span></span>
<span><span class="co">#&gt; 1 2024-02-01         1.1        NA days              1</span></span>
<span><span class="co">#&gt; 2 2024-02-02         0.0      1.00 days              1</span></span>
<span><span class="co">#&gt; 3 2024-02-03         1.4      1.00 days              1</span></span>
<span><span class="co">#&gt; 4 2024-02-04         2.2      1.00 days              1</span></span>
<span><span class="co">#&gt; 5 1970-01-01         3.4 -19757.04 days              2</span></span>
<span><span class="co">#&gt; 6 1970-01-02         0.6      1.00 days              2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="relevant-packages-and-functions">Relevant packages and functions<a class="anchor" aria-label="anchor" href="#relevant-packages-and-functions"></a>
</h2>
<p>The butterfly package was created for a specific use case of handling continuously updating/overwritten timeseries data, where previous values may change without notice.</p>
<p>There are other R packages and functions which handle object comparison, which may suit your specific needs better. Below we describe their overlap and differences to <code>butterfly</code>:</p>
<ul>
<li>
<a href="https://github.com/r-lib/waldo" class="external-link">waldo</a> - <code>butterfly</code> uses <code><a href="https://waldo.r-lib.org/reference/compare.html" class="external-link">waldo::compare()</a></code> in every function to provide a report on difference. There is therefore significant overlap, however <code>butterfly</code> builds on <code>waldo</code> by providing the functionality of comparing objects where we expect some changes, with previous versions but not others. <code>butterfly</code> also provides extra user feedback to provide clarity on what it is and isn’t comparing, due to the nature of comparing only “matched” rows.</li>
<li>
<a href="https://github.com/gowerc/diffdf" class="external-link">diffdf</a> - similar to <code>waldo</code>, but specifically for data frames, <code>diffdf</code> provides the ability to compare data frames directly. We could have used <code>diffdf::diffdf()</code> in our case, but we prefer <code>waldo</code>’s more explicit and clear user feedback. That said, there is significant overlap in functionality: <code><a href="reference/loupe.html">butterfly::loupe()</a></code> and <code>diffdf::diffdf_has_issues()</code> both provide a TRUE/FALSE difference check, while <code>diffdf::diffdf_issue_rows()</code> and <code><a href="reference/catch.html">butterfly::catch()</a></code> both return the rows where changes have occurred. However, it lacks the flexibility of <code>butterfly</code> to compare object where we expect some changes, but not others.</li>
<li>
<a href="https://github.com/tonyfischetti/assertr" class="external-link">assertr</a> - <code>assertr</code> provides assertion functionality that can be used as part of a pipeline, and test assertions on a particular dataset, but it does not offer tools for comparison. We do highly recommend using <code>assertr</code> for checks, prior to using <code>butterfly</code>, as any data quality issues will be caught first.</li>
<li>
<a href="https://github.com/ropensci/daiquiri/" class="external-link">daquiri</a> - <code>daquiri</code> provides tools to check data quality and visually inspect timeseries data. It is also quality assurance package for timeseries, but has a very different purpose to <code>butterfly</code>.</li>
</ul>
<p>Other functions include <code><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal()</a></code> (base R) or <a href="https://github.com/tidyverse/dplyr" class="external-link">dplyr</a>’s <code><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="butterfly-in-production">
<code>butterfly</code> in production<a class="anchor" aria-label="anchor" href="#butterfly-in-production"></a>
</h2>
<p>Read more about how <code>butterfly</code> is <a href="https://thomaszwagerman.github.io/butterfly/articles/butterfly_in_pipeline.html">used in an operational data pipeline</a> to verify a continually updated <strong>and</strong> published dataset.</p>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>For full guidance on contributions, please refer to <code>.github/CONTRIBUTING.md</code>.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that this package is released with a <a href="https://ropensci.org/code-of-conduct/" class="external-link">Contributor Code of Conduct</a>.</p>
<p>By contributing to this project, you agree to abide by its terms.</p>
<div class="section level3">
<h3 id="without-write-access">Without write access<a class="anchor" aria-label="anchor" href="#without-write-access"></a>
</h3>
<p>Corrections, suggestions and general improvements are welcome as issues.</p>
<p>You can also suggest changes by forking this repository, and opening a pull request. Please target your pull requests to the main branch.</p>
</div>
<div class="section level3">
<h3 id="with-write-access">With write access<a class="anchor" aria-label="anchor" href="#with-write-access"></a>
</h3>
<p>You can push directly to main for small fixes. Please use PRs to main for discussing larger updates.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/ropensci/butterfly/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/ropensci/butterfly/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing butterfly</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Thomas Zwagerman <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0009-0003-3742-3234" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/thomaszwagerman/butterfly/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/thomaszwagerman/butterfly/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://app.codecov.io/gh/thomaszwagerman/butterfly?branch=main" class="external-link"><img src="https://codecov.io/gh/thomaszwagerman/butterfly/branch/main/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/thomaszwagerman/butterfly/actions?query=workflow%3Apkgcheck" class="external-link"><img src="https://github.com/thomaszwagerman/butterfly/workflows/pkgcheck/badge.svg" alt="pkgcheck"></a></li>
<li><a href="https://github.com/ropensci/software-review/issues/676" class="external-link"><img src="https://badges.ropensci.org/676_status.svg" alt="Status at rOpenSci Software Peer Review"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Zwagerman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
